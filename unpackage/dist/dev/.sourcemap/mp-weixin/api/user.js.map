{"version":3,"file":"user.js","sources":["api/user.js"],"sourcesContent":["import { http } from './api'\r\n\r\n/**\r\n * 获取用户信息\r\n */\r\nexport const getUserInfo = () => {\r\n//\tawait uni.request({\r\n//\t    url: http + '/user/getUserInfo',\r\n//\t    method: 'GET',\r\n//\t    header: {\r\n//\t        'Authorization': uni.getStorageSync('openid')\r\n//\t    },\r\n//\t    success: (res) => {\r\n//          console.log('getUserInfo: ok')\t\r\n//\t        success(res)\r\n//\t    },\r\n//\t    fail: (res) => {\r\n//\t        fail(res)\r\n//\t    }\r\n//\t})\r\n  return new Promise((resolve) => {\r\n    // 模拟从本地存储获取用户信息\r\n    const userInfo = {\r\n      avatar: uni.getStorageSync('avatar') || '/static/logo.png',\r\n      nickName: uni.getStorageSync('nickName') || '用户' + Math.floor(Math.random() * 10000),\r\n      phone: uni.getStorageSync('phone') || '',\r\n      address: uni.getStorageSync('address') || ''\r\n    }\r\n    \r\n    // 模拟接口延迟\r\n    setTimeout(() => {\r\n      resolve({\r\n        code: 200,\r\n        data: userInfo,\r\n        msg: '获取成功'\r\n      })\r\n    }, 300)\r\n  })\r\n}\r\n\r\n/**\r\n * 更新用户信息\r\n * @param {Object} userData - 用户数据\r\n * @param {string} userData.avatar - 头像URL\r\n * @param {string} userData.nickName - 昵称\r\n * @param {string} userData.phone - 手机号\r\n * @param {string} userData.address - 地址\r\n */\r\nexport const updateUserInfo = (userData) => {\r\n//\tawait uni.request({\r\n//\t    url: http + '/user/getUserInfo',\r\n//\t    method: 'POST',\r\n//\t    header: {\r\n//\t        'Authorization': uni.getStorageSync('openid')\r\n//          'Content-Type': 'application/json'\r\n//\t    },\r\n//      data: userData,\r\n//\t    success: (res) => {\r\n//          console.log('getUserInfo: ok')\t\r\n//\t        success(res)\r\n//\t    },\r\n//\t    fail: (res) => {\r\n//\t        fail(res)\r\n//\t    }\r\n//\t})\r\n  return new Promise((resolve) => {\r\n    // 模拟接口延迟\r\n    setTimeout(() => {\r\n      // 保存到本地存储\r\n      if (userData.avatar) uni.setStorageSync('avatar', userData.avatar)\r\n      if (userData.nickName) uni.setStorageSync('nickName', userData.nickName)\r\n      if (userData.phone) uni.setStorageSync('phone', userData.phone)\r\n      if (userData.address) uni.setStorageSync('address', userData.address)\r\n      \r\n      resolve({\r\n        code: 200,\r\n        data: {\r\n          ...userData,\r\n          updateTime: new Date().toISOString()\r\n        },\r\n        msg: '更新成功'\r\n      })\r\n    }, 500)\r\n  })\r\n}\r\n\r\n/**\r\n * 退出登录\r\n */\r\nexport const logout = () => {\r\n//\tawait uni.request({\r\n//\t    url: http + '/user/logout',\r\n//\t    method: 'POST',\r\n//\t    header: {\r\n//\t        'Authorization': uni.getStorageSync('openid')\r\n//\t    },\r\n//\t    success: (res) => {\r\n//          console.log('logout: ok')\t\r\n//\t        success(res)\r\n//\t    },\r\n//\t    fail: (res) => {\r\n//\t        fail(res)\r\n//\t    }\r\n//\t})\r\n  return new Promise((resolve) => {\r\n    // 清除本地存储的用户信息\r\n    uni.removeStorageSync('token')\r\n    uni.removeStorageSync('avatar')\r\n    uni.removeStorageSync('nickName')\r\n    uni.removeStorageSync('phone')\r\n    uni.removeStorageSync('address')\r\n    \r\n    resolve({\r\n      code: 200,\r\n      msg: '退出成功'\r\n    })\r\n  })\r\n}\r\n\r\n/**\r\n * 上传头像\r\n * @param {string} filePath - 头像文件路径\r\n */\r\nexport const uploadAvatar = (filePath) => {\r\n//\tawait uni.request({\r\n//\t    url: http + '/user/uploadAvatar',\r\n//\t    method: 'POST',\r\n//\t    header: {\r\n//\t        'Authorization': uni.getStorageSync('openid')\r\n//\t    },\r\n//\t    success: (res) => {\r\n//          console.log('uploadAvatar: ok')\t\r\n//\t        success(res)\r\n//\t    },\r\n//\t    fail: (res) => {\r\n//\t        fail(res)\r\n//\t    }\r\n//\t})\r\n  return new Promise((resolve) => {\r\n    // 模拟上传延迟\r\n    setTimeout(() => {\r\n      // 模拟生成头像URL\r\n      const avatarUrl = `/static/logo.png`\r\n      \r\n      resolve({\r\n        code: 200,\r\n        data: {\r\n          avatarUrl\r\n        },\r\n        msg: '上传成功'\r\n      })\r\n    }, 800)\r\n  })\r\n}"],"names":["uni"],"mappings":";;AAKY,MAAC,cAAc,MAAM;AAe/B,SAAO,IAAI,QAAQ,CAAC,YAAY;AAE9B,UAAM,WAAW;AAAA,MACf,QAAQA,cAAG,MAAC,eAAe,QAAQ,KAAK;AAAA,MACxC,UAAUA,cAAG,MAAC,eAAe,UAAU,KAAK,OAAO,KAAK,MAAM,KAAK,OAAM,IAAK,GAAK;AAAA,MACnF,OAAOA,cAAG,MAAC,eAAe,OAAO,KAAK;AAAA,MACtC,SAASA,cAAG,MAAC,eAAe,SAAS,KAAK;AAAA,IAC3C;AAGD,eAAW,MAAM;AACf,cAAQ;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,KAAK;AAAA,MACb,CAAO;AAAA,IACF,GAAE,GAAG;AAAA,EACV,CAAG;AACH;AAUY,MAAC,iBAAiB,CAAC,aAAa;AAiB1C,SAAO,IAAI,QAAQ,CAAC,YAAY;AAE9B,eAAW,MAAM;AAEf,UAAI,SAAS;AAAQA,sBAAG,MAAC,eAAe,UAAU,SAAS,MAAM;AACjE,UAAI,SAAS;AAAUA,sBAAG,MAAC,eAAe,YAAY,SAAS,QAAQ;AACvE,UAAI,SAAS;AAAOA,sBAAG,MAAC,eAAe,SAAS,SAAS,KAAK;AAC9D,UAAI,SAAS;AAASA,sBAAG,MAAC,eAAe,WAAW,SAAS,OAAO;AAEpE,cAAQ;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,UACJ,GAAG;AAAA,UACH,aAAY,oBAAI,KAAM,GAAC,YAAa;AAAA,QACrC;AAAA,QACD,KAAK;AAAA,MACb,CAAO;AAAA,IACF,GAAE,GAAG;AAAA,EACV,CAAG;AACH;AAKY,MAAC,SAAS,MAAM;AAe1B,SAAO,IAAI,QAAQ,CAAC,YAAY;AAE9BA,kBAAG,MAAC,kBAAkB,OAAO;AAC7BA,kBAAG,MAAC,kBAAkB,QAAQ;AAC9BA,kBAAG,MAAC,kBAAkB,UAAU;AAChCA,kBAAG,MAAC,kBAAkB,OAAO;AAC7BA,kBAAG,MAAC,kBAAkB,SAAS;AAE/B,YAAQ;AAAA,MACN,MAAM;AAAA,MACN,KAAK;AAAA,IACX,CAAK;AAAA,EACL,CAAG;AACH;AAMY,MAAC,eAAe,CAAC,aAAa;AAexC,SAAO,IAAI,QAAQ,CAAC,YAAY;AAE9B,eAAW,MAAM;AAEf,YAAM,YAAY;AAElB,cAAQ;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,UACJ;AAAA,QACD;AAAA,QACD,KAAK;AAAA,MACb,CAAO;AAAA,IACF,GAAE,GAAG;AAAA,EACV,CAAG;AACH;;;;;"}